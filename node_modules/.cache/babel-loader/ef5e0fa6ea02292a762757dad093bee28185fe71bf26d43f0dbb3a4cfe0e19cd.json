{"ast":null,"code":"import _slicedToArray from\"/home/dipti/Codes/Dursikshya 1-2/REACT/Ecommerce_React_main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _defineProperty from\"/home/dipti/Codes/Dursikshya 1-2/REACT/Ecommerce_React_main/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/home/dipti/Codes/Dursikshya 1-2/REACT/Ecommerce_React_main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useReducer,useRef,useState}from'react';import{useParams}from'react-router-dom';import{API}from'../../../../config';import{getAllCategories}from'../../../api/categoryAPI';import{addProduct,productDetails,updateProduct}from'../../../api/productAPI';import{isAuthenticated}from'../../../api/userAPI';import Navbar from'../../Navbar';import AdminCategories from'./AdminCategories';import AdminSidebar from'./AdminSidebar';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UpdateProduct=function UpdateProduct(){var _useParams=useParams(),id=_useParams.id;var sel_ref=useRef();var productReducer=function productReducer(state,action){switch(action.type){case\"loadProduct\":sel_ref.current=action.payload.category._id;return _objectSpread(_objectSpread({},state),action.payload);default:if(action.target.name=\"product_image\"){return _objectSpread(_objectSpread({},state),{},_defineProperty({},action.target.name,action.target.files[0]));}else{return _objectSpread(_objectSpread({},state),{},_defineProperty({},action.target.name,action.target.value));}}};var _useReducer=useReducer(productReducer,{formdata:new FormData()}),_useReducer2=_slicedToArray(_useReducer,2),product=_useReducer2[0],setProduct=_useReducer2[1];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),categories=_useState2[0],setCategories=_useState2[1];var token=isAuthenticated;var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),success=_useState6[0],setSuccess=_useState6[1];var product_name=product.product_name,product_image=product.product_image,product_price=product.product_price,count_in_stock=product.count_in_stock,product_description=product.product_description;useEffect(function(){getAllCategories().then(function(data){if(data.error){console.log(data.error);}else{setCategories(data);}});productDetails(id).then(function(data){if(data.error){console.log(data.error);}else{console.log(data);setProduct({type:\"loadProduct\",payload:data});}});},[]);//console.log(formdata)\nvar handleSubmit=function handleSubmit(e){e.preventDefault();updateProduct(id,product.formdata,token).then(function(data){if(data.error){setError(data.error);setSuccess(false);}else{setSuccess(true);setError('');}});};var showError=function showError(){if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"alert-alert-danger\",children:error});}};var showSuccess=function showSuccess(){if(success){return/*#__PURE__*/_jsx(\"div\",{className:\"alert-alert-success\",children:\"Product added successfully.\"});}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-3 col-sm-6\",children:/*#__PURE__*/_jsx(AdminSidebar,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-9 col-sm-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-success text-decoration-underline pt-3\",children:\"Add new product.\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"w-50 px-5 pt-3 pb-5 p-5 my-3 shadow-lg text-decoration-underline\",children:[showError(),showSuccess(),/*#__PURE__*/_jsx(\"h3\",{children:\"Product Details\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"product_name\",children:\"Product Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"product_name\",onChange:setProduct,value:product_name}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"product_name\",children:\"Product Price\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"product_price\",onChange:setProduct,value:product_price}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"product_name\",children:\"Product Description\"}),/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",className:\"form-control\",name:\"product_description\",onChange:setProduct,value:product_description}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"product_name\",children:\"Count in stock\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control\",name:\"count_in_stock\",onChange:setProduct,value:count_in_stock}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"product_name\",children:\"Product Image\"}),/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(API,\"/\").concat(product_image),alt:product_name,style:{height:\"300px\"}}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",className:\"form-control\",name:\"product_image\",onChange:setProduct}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"product_name\",children:\"Category\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"category\",id:\"\",className:\"form-control\",onChange:setProduct,ref:sel_ref,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choose Category\"}),categories.map(function(category){return/*#__PURE__*/_jsx(\"option\",{value:category._id,children:category.category_name},category._id);})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-warning mt-2 w-100\",onClick:handleSubmit,children:\"Update Product\"})]})]})]})})]});};export default UpdateProduct;","map":{"version":3,"names":["React","useEffect","useReducer","useRef","useState","useParams","API","getAllCategories","addProduct","productDetails","updateProduct","isAuthenticated","Navbar","AdminCategories","AdminSidebar","UpdateProduct","id","sel_ref","productReducer","state","action","type","current","payload","category","_id","target","name","files","value","formdata","FormData","product","setProduct","categories","setCategories","token","error","setError","success","setSuccess","product_name","product_image","product_price","count_in_stock","product_description","then","data","console","log","handleSubmit","e","preventDefault","showError","showSuccess","height","map","category_name"],"sources":["/home/dipti/Codes/Dursikshya 1-2/REACT/Ecommerce_React_main/src/Components/Layout/Pages/Admin/UpdateProduct.jsx"],"sourcesContent":["import React, { useEffect, useReducer, useRef, useState } from 'react'\nimport { useParams } from 'react-router-dom'\nimport { API } from '../../../../config'\nimport { getAllCategories } from '../../../api/categoryAPI'\nimport { addProduct, productDetails, updateProduct } from '../../../api/productAPI'\nimport { isAuthenticated } from '../../../api/userAPI'\nimport Navbar from '../../Navbar'\nimport AdminCategories from './AdminCategories'\nimport AdminSidebar from './AdminSidebar'\n\nconst UpdateProduct = () => {\n    const {id} = useParams()\n\n    const sel_ref = useRef()\n    \n    const productReducer = (state, action) => {\n        switch(action.type) {\n          case \"loadProduct\":\n            sel_ref.current = action.payload.category._id\n            return {...state, ...action.payload}\n            default:\n              if(action.target.name = \"product_image\") {\n                return {...state, [action.target.name]: action.target.files[0]}\n              } else {\n                return {...state, [action.target.name]:action.target.value}\n        \n              }\n        }\n    }\n\n    \n    const [product, setProduct] = useReducer(productReducer, {formdata: new FormData})\n\n    const[categories, setCategories] = useState([])\n    const token = isAuthenticated\n\n    let [error, setError] = useState('')\n    let [success, setSuccess] = useState(false)\n    const{product_name, product_image, product_price, count_in_stock, product_description} = product\n\n    useEffect(() => {\n      getAllCategories()\n      .then(data => {\n        if(data.error) {\n          console.log(data.error)\n         }\n        else {\n          setCategories(data)\n        }\n      })\n      productDetails(id)\n      .then(data => {\n        if(data.error) {\n            console.log(data.error)\n        }\n        else {\n            console.log(data)\n            setProduct ({type: \"loadProduct\", payload:data})\n        }\n      })\n    }, [])\n\n\n\n    //console.log(formdata)\n\n    const handleSubmit = e => {\n      e.preventDefault()\n      updateProduct(id, product.formdata, token)\n      .then(data => {\n        if(data.error) {\n          setError(data.error)\n          setSuccess(false)\n        }\n        else {\n          setSuccess(true)\n          setError('')\n        }\n      })\n    }\n\n    const showError = () => {\n      if(error) {\n        return <div className = 'alert-alert-danger'>{error}</div>\n      }\n    }\n\n    const showSuccess = () => {\n      if(success) {\n        return <div className = 'alert-alert-success'>Product added successfully.</div>\n      } \n    }    \n  return (\n    <>\n     <Navbar/>\n   <div className=\"container-fluid\">\n    <div className=\"row\">\n      <div className=\"col-md-3 col-sm-6\">\n      <AdminSidebar/>\n      </div>\n      <div className=\"col-md-9 col-sm-6\">\n        <h3 className = 'text-success text-decoration-underline pt-3'>Add new product.</h3>\n\n    <form className = 'w-50 px-5 pt-3 pb-5 p-5 my-3 shadow-lg text-decoration-underline'>\n      {showError()}\n      {showSuccess()}\n      <h3>Product Details</h3>\n        <label htmlFor = \"product_name\">Product Name</label>\n        <input type = \"text\" className = 'form-control' name = 'product_name' onChange = {setProduct} value={product_name}/>\n\n        <label htmlFor = \"product_name\">Product Price</label>\n        <input type = \"text\" className = 'form-control' name = 'product_price' onChange = {setProduct} value={product_price}/>\n\n        <label htmlFor = \"product_name\">Product Description</label>\n        <textarea type = \"text\" className = 'form-control' name = 'product_description' onChange = {setProduct} value={product_description}/>\n\n        <label htmlFor = \"product_name\">Count in stock</label>\n        <input type = \"number\" className = 'form-control' name = 'count_in_stock' onChange = {setProduct} value={count_in_stock}/>\n\n        <label htmlFor = \"product_name\">Product Image</label>\n        <img src = {`${API}/${product_image}`} alt = {product_name} style = {{height: \"300px\"}}/>\n        <input type = \"file\" className = 'form-control' name = 'product_image' onChange = {setProduct}/>\n\n        <label htmlFor = \"product_name\">Category</label>\n        <select name = \"category\" id = \"\" className = 'form-control' onChange = {setProduct} ref = {sel_ref}>\n          <option value=\"\">Choose Category</option>\n          {\n            categories.map(category => {\n              return <option value = {category._id} key={category._id}>{category.category_name}</option>\n            })\n          }\n        </select>\n\n        <button className = \"btn btn-warning mt-2 w-100\" onClick = {handleSubmit}>Update Product</button>\n    </form>\n\n      </div>\n\n    </div>\n   </div>\n    </>\n  )\n}\n\nexport default UpdateProduct"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}